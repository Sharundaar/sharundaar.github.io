<!DOCTYPE html>
<html lang="en">
  <head>
        <title>Sharundaar's Blog - A Quick Dive in Unreal Windows Contextual Commands</title>
      <meta charset="utf-8" />
      <meta name="generator" content="Pelican" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>
      <script src="./theme/scripts/dropdown.js" defer></script>
      <script src="./theme/scripts/copy-to-clipboard.js" defer></script>
      <link rel="stylesheet" type="text/css" href="./theme/css/style.css" />
      <link rel="stylesheet" type="text/css" href="./theme/css/code-highlights.css" />



<script async data-id="101425269" src="//static.getclicky.com/js"></script>






  </head>

  <body class="bg-dark d-flex mb-4">
    <aside class="sh-offcanvas sh-offcanvas-start d-lg-block me-4 bg-dark flex-shrink-0" tabindex="-1" id="offcanvas-sidebar" aria-labelledby="sidebarLabel">
      <div class="sticky-top ms-4">
        <div>
            <hgroup class="d-inline-flex align-items-center">
                <img alt="Profile Picture" class="profile-pic img-fluid me-2" src="./theme/images/tony-slurp.jpg">
                <h1 class="flex-shrink-1">Sharundaar</h1>
            </hgroup>
            <div class="d-flex justify-content-between">
            <div>
<a class="social-link" href=".">
<svg fill="#fff" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
    width="24px" height="24px" viewBox="0 0 495.398 495.398"
    xml:space="preserve">
<g><g><g>
    <path d="M487.083,225.514l-75.08-75.08V63.704c0-15.682-12.708-28.391-28.413-28.391c-15.669,0-28.377,12.709-28.377,28.391
        v29.941L299.31,37.74c-27.639-27.624-75.694-27.575-103.27,0.05L8.312,225.514c-11.082,11.104-11.082,29.071,0,40.158
        c11.087,11.101,29.089,11.101,40.172,0l187.71-187.729c6.115-6.083,16.893-6.083,22.976-0.018l187.742,187.747
        c5.567,5.551,12.825,8.312,20.081,8.312c7.271,0,14.541-2.764,20.091-8.312C498.17,254.586,498.17,236.619,487.083,225.514z"/>
    <path d="M257.561,131.836c-5.454-5.451-14.285-5.451-19.723,0L72.712,296.913c-2.607,2.606-4.085,6.164-4.085,9.877v120.401
        c0,28.253,22.908,51.16,51.16,51.16h81.754v-126.61h92.299v126.61h81.755c28.251,0,51.159-22.907,51.159-51.159V306.79
        c0-3.713-1.465-7.271-4.085-9.877L257.561,131.836z"/>
    </g></g></g>
</svg>
</a>            </div>
            <div class="m-0">
<div id="sidebar-social-link" class="d-flex">
    <a class="social-link" href="https://bsky.app/profile/sharundaar.bsky.social" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg width="100%" height="100%" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M20.4,0c1.988,0 3.6,1.612 3.6,3.6l-0,16.8c-0,1.988 -1.612,3.6 -3.6,3.6l-16.8,-0c-1.988,-0 -3.6,-1.612 -3.6,-3.6l-0,-16.8c0,-1.988 1.612,-3.6 3.6,-3.6l16.8,-0Z" style="fill:#fff;"/><clipPath id="_clip1"><path d="M20.4,0c1.988,0 3.6,1.612 3.6,3.6l-0,16.8c-0,1.988 -1.612,3.6 -3.6,3.6l-16.8,-0c-1.988,-0 -3.6,-1.612 -3.6,-3.6l-0,-16.8c0,-1.988 1.612,-3.6 3.6,-3.6l16.8,-0Z"/></clipPath><g clip-path="url(#_clip1)"><path d="M12,11.006c-0.9,-1.75 -3.35,-5.012 -5.628,-6.62c-2.183,-1.54 -3.015,-1.274 -3.561,-1.026c-0.631,0.284 -0.747,1.254 -0.747,1.824c0,0.571 0.313,4.678 0.517,5.364c0.675,2.266 3.074,3.031 5.285,2.785c0.113,-0.016 0.228,-0.032 0.344,-0.046c-0.115,0.018 -0.229,0.033 -0.344,0.046c-3.239,0.481 -6.116,1.661 -2.343,5.861c4.15,4.297 5.688,-0.922 6.477,-3.567c0.789,2.645 1.697,7.676 6.403,3.567c3.533,-3.567 0.97,-5.38 -2.269,-5.861c-0.115,-0.012 -0.229,-0.028 -0.344,-0.046c0.116,0.014 0.231,0.03 0.344,0.046c2.211,0.246 4.61,-0.519 5.285,-2.785c0.204,-0.685 0.517,-4.794 0.517,-5.363c-0,-0.572 -0.116,-1.541 -0.747,-1.827c-0.546,-0.247 -1.378,-0.513 -3.561,1.027c-2.278,1.61 -4.728,4.872 -5.628,6.621Z" style="fill:#3088d4;fill-rule:nonzero;"/></g></svg>
    </a>
    <a class="social-link" href="https://github.com/Sharundaar" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a class="social-link" href="https://mastodon.gamedev.place/@Sharundaar" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Mastodon" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%"/><path d="m409 290c-5 24-43 50-85 56-86 11-137-6-137-6 3 13-4 54 70 52 31 0 58-7 58-7l2 27c-51 24-107 15-140 6-67-17-79-90-81-162v-59c0-74 49-96 49-96 50-24 180-22 222 0 0 0 49 22 49 96 0 0 1 55-7 93" fill="#3088d4"/><path d="m358 202v91h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60"/></svg>
    </a>
</div>
            </div>
            </div>
        </div>
        <nav>
            <ul class="list-unstyled ps-0 pt-4">
  <li class="mb-1">
    <div id="toc"><ul class="list-unstyled mb-1"><li class="btn-toggle-nav mb-1 nav-item"><a class="link-body-emphasis d-inline-flex text-decoration-none rounded nav-link ms-0 fs-4" href="#introduction" title="Introduction">Introduction</a></li><li class="btn-toggle-nav mb-1 nav-item"><a class="link-body-emphasis d-inline-flex text-decoration-none rounded nav-link ms-0 fs-4" href="#the-windows-contextual-menu" title="The Windows Contextual Menu">The Windows Contextual Menu</a></li><li class="btn-toggle-nav mb-1 nav-item"><a class="link-body-emphasis d-inline-flex text-decoration-none rounded nav-link ms-0 fs-4" href="#unrealversionselector" title="UnrealVersionSelector">UnrealVersionSelector</a></li><li class="btn-toggle-nav mb-1 nav-item"><a class="link-body-emphasis d-inline-flex text-decoration-none rounded nav-link ms-0 fs-4" href="#conclusion" title="Conclusion">Conclusion</a></li></ul></div>
  </div>
            </ul>
        </nav>
        </div>
    </aside>
    <main class="container overflow-auto">
      <div class="d-lg-none">
      <div class="d-flex justify-content-between align-items-center">
        <hgroup class="d-inline-flex align-items-center">
        <img alt="Profile Picture" class="profile-pic img-fluid me-2" src="./theme/images/tony-slurp.jpg">
        <h1 class="flex-shrink-1">Sharundaar</h1>
        </hgroup>
        <button class="btn btn-dark d-lg-none m-2 d-flex align-items-center justify-content-center" 
        type="button" 
        data-bs-toggle="offcanvas" 
        data-bs-target="#offcanvas-sidebar" 
        aria-controls="offcanvas-sidebar">
        <span class="navbar-toggler-icon"></span>
        </button>
      </div>
      <div class="d-flex justify-content-between">
        <div>
<a class="social-link" href=".">
<svg fill="#fff" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
    width="24px" height="24px" viewBox="0 0 495.398 495.398"
    xml:space="preserve">
<g><g><g>
    <path d="M487.083,225.514l-75.08-75.08V63.704c0-15.682-12.708-28.391-28.413-28.391c-15.669,0-28.377,12.709-28.377,28.391
        v29.941L299.31,37.74c-27.639-27.624-75.694-27.575-103.27,0.05L8.312,225.514c-11.082,11.104-11.082,29.071,0,40.158
        c11.087,11.101,29.089,11.101,40.172,0l187.71-187.729c6.115-6.083,16.893-6.083,22.976-0.018l187.742,187.747
        c5.567,5.551,12.825,8.312,20.081,8.312c7.271,0,14.541-2.764,20.091-8.312C498.17,254.586,498.17,236.619,487.083,225.514z"/>
    <path d="M257.561,131.836c-5.454-5.451-14.285-5.451-19.723,0L72.712,296.913c-2.607,2.606-4.085,6.164-4.085,9.877v120.401
        c0,28.253,22.908,51.16,51.16,51.16h81.754v-126.61h92.299v126.61h81.755c28.251,0,51.159-22.907,51.159-51.159V306.79
        c0-3.713-1.465-7.271-4.085-9.877L257.561,131.836z"/>
    </g></g></g>
</svg>
</a>        </div>
        <div class="m-0">
<div id="sidebar-social-link" class="d-flex">
    <a class="social-link" href="https://bsky.app/profile/sharundaar.bsky.social" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg width="100%" height="100%" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M20.4,0c1.988,0 3.6,1.612 3.6,3.6l-0,16.8c-0,1.988 -1.612,3.6 -3.6,3.6l-16.8,-0c-1.988,-0 -3.6,-1.612 -3.6,-3.6l-0,-16.8c0,-1.988 1.612,-3.6 3.6,-3.6l16.8,-0Z" style="fill:#fff;"/><clipPath id="_clip1"><path d="M20.4,0c1.988,0 3.6,1.612 3.6,3.6l-0,16.8c-0,1.988 -1.612,3.6 -3.6,3.6l-16.8,-0c-1.988,-0 -3.6,-1.612 -3.6,-3.6l-0,-16.8c0,-1.988 1.612,-3.6 3.6,-3.6l16.8,-0Z"/></clipPath><g clip-path="url(#_clip1)"><path d="M12,11.006c-0.9,-1.75 -3.35,-5.012 -5.628,-6.62c-2.183,-1.54 -3.015,-1.274 -3.561,-1.026c-0.631,0.284 -0.747,1.254 -0.747,1.824c0,0.571 0.313,4.678 0.517,5.364c0.675,2.266 3.074,3.031 5.285,2.785c0.113,-0.016 0.228,-0.032 0.344,-0.046c-0.115,0.018 -0.229,0.033 -0.344,0.046c-3.239,0.481 -6.116,1.661 -2.343,5.861c4.15,4.297 5.688,-0.922 6.477,-3.567c0.789,2.645 1.697,7.676 6.403,3.567c3.533,-3.567 0.97,-5.38 -2.269,-5.861c-0.115,-0.012 -0.229,-0.028 -0.344,-0.046c0.116,0.014 0.231,0.03 0.344,0.046c2.211,0.246 4.61,-0.519 5.285,-2.785c0.204,-0.685 0.517,-4.794 0.517,-5.363c-0,-0.572 -0.116,-1.541 -0.747,-1.827c-0.546,-0.247 -1.378,-0.513 -3.561,1.027c-2.278,1.61 -4.728,4.872 -5.628,6.621Z" style="fill:#3088d4;fill-rule:nonzero;"/></g></svg>
    </a>
    <a class="social-link" href="https://github.com/Sharundaar" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a class="social-link" href="https://mastodon.gamedev.place/@Sharundaar" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Mastodon" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%"/><path d="m409 290c-5 24-43 50-85 56-86 11-137-6-137-6 3 13-4 54 70 52 31 0 58-7 58-7l2 27c-51 24-107 15-140 6-67-17-79-90-81-162v-59c0-74 49-96 49-96 50-24 180-22 222 0 0 0 49 22 49 96 0 0 1 55-7 93" fill="#3088d4"/><path d="m358 202v91h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60"/></svg>
    </a>
</div>
        </div>
      </div>
      </div>
  <article class="mb-4 mt-4">
    <header class="mb-4">
      <h1 class="mb-0">
        <a href="./a-quick-dive-in-unreal-windows-contextual-commands.html" rel="bookmark"
           title="Permalink to A Quick Dive in Unreal Windows Contextual Commands">
           A Quick Dive in Unreal Windows Contextual Commands
        </a>
      </h1>
      <time datetime="2023-03-20T00:00:00-04:00">20 Mar 2023</time>
      
    </header>
    <div data-bs-spy="scroll" data-bs-target="#toc">
    <div class="section" id="introduction">
<h2 id="introduction">Introduction</h2>
<p>I was trying to resolve some project solution generation issues a few weeks ago and it led me to wonder: What are those ?</p>
<p>
<p class="text-center img-wrapper"><img alt="Windows Contextual commands with Launch Game, Generate Visual Studio project files, and Switch Unreal Engine version..." class="img-fluid" src="./images/DiveInUnrealCommands/contextual-menu.png" title="Windows Contextual commands with Launch Game, Generate Visual Studio project files, and Switch Unreal Engine version..."/></p>
</p>
<p>What exactly happens when we click those commands ? Well I searched a bit and thought I'd write down my findings here 😄. Let's have fun.</p>
</div>
<div class="section" id="the-windows-contextual-menu">
<h2 id="the-windows-contextual-menu">The Windows Contextual Menu</h2>
<p>In case you didn't know, the windows contextual menu is actually fairly customizable. The way it's stored is through the windows Registry in the file association department :)</p>
<p>I invite you to go take a look at the <a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/hkey-classes-root-key">documentation page</a> ! But I'm going to detail the adventure a bit.</p>
<p>So ! Win+R to bring up the start menu, <code>regedit</code> and enter to open the registry editor ! We're in (relatively) dangerous territory here so don't change anything until you know what you're doing.</p>
<p>It should look something like that :</p>
<p>
<p class="text-center img-wrapper"><img alt="Naked Registry Editor window" class="img-fluid" src="./images/DiveInUnrealCommands/regedit.png" title="Naked Registry Editor window"/></p>
</p>
<p>From there you might be asking what are we looking for ? There's a bajillion keys and the organization is a secret known only to the gods ! Well no worries, we actually have some piece of texts to put our foot in the door, chiefly "Switch Unreal Engine version" ! It's a sufficiently unique string that whatever match we find should represent the contextual menu command we're looking for.</p>
<p>So, CTRL+F, input the string (we don't care about the settings just make sure Data is checked), and search ! It's going to take a little while, there's a lot of stuff in there, but it should find an entry like <code>HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\switchversion</code>. </p>
<p>What are we looking at ? The anatomy of a registry entry is relatively simple :</p>
<p>
<p class="text-center img-wrapper"><img alt="Screenshot of regedit pointing at HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\switchversion, arrows describe what each part is." class="img-fluid" src="./images/DiveInUnrealCommands/anatomy-registry.png" title="Screenshot of regedit pointing at HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\switchversion, arrows describe what each part is."/></p>
</p>
<p>Each "folder" is a key, each key can have child keys which builds a hierarchy. Each key can also have one or multiple values associated (always at least one, the Default). And each value can have Data associated. To be noted that everything here is identified with a string.</p>
<p>It's here that I encourage you to check the <a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/hkey-classes-root-key">documentation page</a> again 😁</p>
<p>Windows has 2 levels of file association, machine and user space, the defaults are stored in HKEY_LOCAL_MACHINE\Software\Classes, the user specifics in HKEY_CURRENT_USER\Software\Classes, and HKEY_CLASSES_ROOT is actually just a merged view of both those keys !</p>
<p>if you've ever ran an installer and got the question "Do you want to install for all users or just the current one" now you know what's happening behind the scene ! (Well there's some subtilties depending on context but the idea is the same)</p>
<p>Alright ! Let's take a look at this registry structure. Unreal stores all the commands under <code>HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell</code>, Windows knows to display those commands thanks to the file association found in <code>HKEY_CLASSES_ROOT\.uproject</code> ! You can this key's value is set to <code>Unreal.ProjectFile</code>.</p>
<p>If we check the structure of that key, we'll find DefaultIcon which points to the icon displayed in the explorer, and a bunch of shell commands :</p>
<p>
<p class="text-center img-wrapper"><img alt="regedit tree view centered on the Unreal.ProjectFile key, there's a DefaultIcon and shell child keys, the shell key has 4 children : open, run, rungenproj, switchversion" class="img-fluid" src="./images/DiveInUnrealCommands/unreal-projectfile.png" title="regedit tree view centered on the Unreal.ProjectFile key, there's a DefaultIcon and shell child keys, the shell key has 4 children : open, run, rungenproj, switchversion"/></p>
</p>
<p>Taking a look at <code>switchversion</code>, you can find the (Default) and Icon values are used by the contextual menu, while a <code>command</code> child key registers the actual shell code that runs when we click the menu item.</p>
<p>In particular, on my current version and install : <br/><code>"D:\Epic Games\Launcher\Engine\Binaries\Win64\UnrealVersionSelector.exe" /switchversion "%1"</code></p>
<p>Alright ! One mystery solved. We now know that all those commands boils down to executing <code>UnrealVersionSelector.exe</code> with various / commands and the file path (<code>%1</code>)</p>
<p>On to the next one, what up with UnrealVersionSelector ? ╰(<em>&deg;&xdtri;&deg;</em>)╯</p>
</div>
<div class="section" id="unrealversionselector">
<h2 id="unrealversionselector">UnrealVersionSelector</h2>
<p>Lucky for us, the UnrealVersionSelector tool source code is available on the official Unreal github ! We can go take a look at exactly what those command arguments do, as a quick list the registered commands looks like this:</p>
<ul>
<li>switchversion: /switchversion</li>
<li>rungenproj: /projectfiles</li>
<li>run: /game</li>
<li>open: /editor</li>
</ul>
<p>A quick search gives us all of the commands, and even new ones &gt;:) </p>
<div class="highlight table-responsive"><table class="highlight table-responsivetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Note: Cut down for brevity</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// Add the current directory to the list of installations</span>
<span class="w">    </span><span class="n">bRes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">RegisterCurrentEngineDirectoryWithPrompt</span><span class="p">();</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-register"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Add the current directory to the list of installations</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-register"</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-unattended"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Add the current directory to the list of installations</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-fileassociations"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Update all the settings.</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-switchversion"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Associate with an engine label</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-switchversionsilent"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Associate with a specific engine label</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-editor"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Open a project with the editor</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-projectlist"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Open the editor</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-game"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Play a game using the editor executable</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Arguments</span><span class="p">.</span><span class="n">Num</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TEXT</span><span class="p">(</span><span class="s">"-projectfiles"</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Generate Visual Studio project files</span>
<span class="k">else</span>
<span class="w">    </span><span class="c1">// Invalid command line</span>
</code></pre></div></td></tr></table></div>
<p>If we dive a bit into the code we can find a lot of details about how unreal finds installations and how it registers stuff, notably I was wondering what the GUID found under <code>EngineAssociation</code> corresponds to in the .uproject file.</p>
<p>Well you can register custom installations of the engine by navigating to your unreal source folder and running <code>UnrealVersionSelector.exe -register</code>.</p>
<p>This adds a key to the registry under the path <br/><code>HKEY_CURRENT_USER\SOFTWARE\Epic Games\Unreal Engine\Builds</code>&nbsp;which matches that GUID to your install folder ! I think that was pretty interesting, if you're curious to learn more it's all happening in those files (on windows) :</p>
<ul>
<li><code>Source\Developer\DesktopPlatform\Private\DesktopPlatformBase.cpp</code></li>
<li><code>Source\Developer\DesktopPlatform\Private\DesktopPlatformWindows.cpp</code></li>
</ul>
<p>An other interesting function to look at is <code>EnumerateLauncherEngineInstallations</code>, we can see here that everything that the Epic Launcher installs is actually saved in a .dat file in ProgramData <code>C:\ProgramData\Epic\UnrealEngineLauncher\LauncherInstalled.dat</code>. I won't spoil the content but you can parse the file yourself 😏</p>
</div>
<div class="section" id="conclusion">
<h2 id="conclusion">Conclusion</h2>
<p>I hope you liked this little dive in windows belly ! And some of those keys about the unreal version selector. I think it's good knowledge to have when we're trying to debug project setup issues 😁</p>
<p>If you make new tools now you should be able to plug them in the contextual menu fairly easily for your clients ! And if you ever wonder what a tool does when you click its contextual menu button you should be able to find out what 😄</p>
</div>
    </div>
  </article>
    </main>
    <footer class="fixed-bottom py-1 d-flex flex-wrap justify-content-center align-items-center border-top bg-dark">
        <a href="#" class="text-center link-body-emphasis text-decoration-none rounded">Back to top</a>
        <!-- <address class="col-md-4 text-body-secondary text-end m-1">
          Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>,
          which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
        </address> -->
    </footer>
  </body>
</html>